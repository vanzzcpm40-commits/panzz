<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>luvv</title>
  <style>
    html, body { margin:0; padding:0; width:100%; height:100%; overflow:hidden; background:#000; }
    canvas { display:block; width:100vw; height:100vh; }
  </style>
</head>
<body>
  <canvas id="c"></canvas>

  <script>
    const BG_SRC = "tamanbunga.jpg";
    const CENTER_TEXT = "piraaaðŸ¤ðŸ¤ðŸ’";

    const canvas = document.getElementById("c");
    const ctx = canvas.getContext("2d", { alpha: true });

    let W = 0, H = 0, DPR = 1;

    function resize(){
      DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      W = Math.floor(window.innerWidth);
      H = Math.floor(window.innerHeight);
      canvas.width = Math.floor(W * DPR);
      canvas.height = Math.floor(H * DPR);
      canvas.style.width = W + "px";
      canvas.style.height = H + "px";
      ctx.setTransform(DPR,0,0,DPR,0,0);
    }
    window.addEventListener("resize", resize, { passive:true });
    resize();

    const rand = (a,b)=>a+Math.random()*(b-a);
    const clamp=(x,a,b)=>Math.max(a,Math.min(b,x));
    const pick = (arr)=>arr[(Math.random()*arr.length)|0];

    const pointer = { x: W*0.5, y: H*0.55, down:false, live:false, t:0 };

    window.addEventListener("pointermove", (e)=>{
      pointer.x = e.clientX; pointer.y = e.clientY;
      pointer.live = true; pointer.t = 0;
      spawnBurst(pointer.x, pointer.y, 8);
    }, { passive:true });

    window.addEventListener("pointerdown", (e)=>{
      pointer.down = true;
      pointer.x = e.clientX; pointer.y = e.clientY;
      pointer.live = true;
      pointer.t = 0;
      spawnBurst(pointer.x, pointer.y, 16);
    }, { passive:true });

    window.addEventListener("pointerup", ()=>{ pointer.down = false; }, { passive:true });
    window.addEventListener("pointerleave", ()=>{ pointer.live = false; }, { passive:true });

    function heartPoint(t){
      const x = 16 * Math.pow(Math.sin(t), 3);
      const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
      return { x, y };
    }

    function drawTinyHeart(x,y,s,rot,color,a){
      ctx.save();
      ctx.translate(x,y);
      ctx.rotate(rot);
      ctx.globalAlpha = a;
      ctx.fillStyle = color;
      ctx.beginPath();
      ctx.moveTo(0, s*0.6);
      ctx.bezierCurveTo(s*1.1, -s*0.2, s*0.7, -s*1.1, 0, -s*0.6);
      ctx.bezierCurveTo(-s*0.7, -s*1.1, -s*1.1, -s*0.2, 0, s*0.6);
      ctx.closePath();
      ctx.fill();
      ctx.restore();
    }

    function drawFlower(x,y,r,rot,colors,a){
      ctx.save();
      ctx.translate(x,y);
      ctx.rotate(rot);
      ctx.globalAlpha = a;
      for(let i=0;i<5;i++){
        ctx.rotate((Math.PI*2)/5);
        ctx.fillStyle = colors[i%colors.length];
        ctx.beginPath();
        ctx.ellipse(r*0.85, 0, r*0.95, r*0.58, 0, 0, Math.PI*2);
        ctx.fill();
      }
      ctx.fillStyle = "rgba(255,255,255,0.85)";
      ctx.beginPath();
      ctx.arc(0,0,r*0.35,0,Math.PI*2);
      ctx.fill();
      ctx.restore();
    }

    function roundRectPath(x,y,w,h,r){
      r = Math.max(0, Math.min(r, Math.min(w,h)/2));
      ctx.beginPath();
      ctx.moveTo(x+r, y);
      ctx.lineTo(x+w-r, y);
      ctx.quadraticCurveTo(x+w, y, x+w, y+r);
      ctx.lineTo(x+w, y+h-r);
      ctx.quadraticCurveTo(x+w, y+h, x+w-r, y+h);
      ctx.lineTo(x+r, y+h);
      ctx.quadraticCurveTo(x, y+h, x, y+h-r);
      ctx.lineTo(x, y+r);
      ctx.quadraticCurveTo(x, y, x+r, y);
      ctx.closePath();
    }

    function drawButterfly(x, y, s, rot, flap, a, col){
      ctx.save();
      ctx.translate(x, y);
      ctx.rotate(rot);
      ctx.globalAlpha = a;

      const wing = s * (0.9 + 0.25*Math.sin(flap));
      ctx.fillStyle = col;

      ctx.beginPath();
      ctx.ellipse(-s*0.55, 0, wing, s*0.7, 0, 0, Math.PI*2);
      ctx.ellipse(-s*0.05, -s*0.25, wing*0.75, s*0.55, 0, 0, Math.PI*2);
      ctx.fill();

      ctx.beginPath();
      ctx.ellipse(s*0.55, 0, wing, s*0.7, 0, 0, Math.PI*2);
      ctx.ellipse(s*0.05, -s*0.25, wing*0.75, s*0.55, 0, 0, Math.PI*2);
      ctx.fill();

      ctx.fillStyle = "rgba(255,255,255,0.9)";
      roundRectPath(-s*0.10, -s*0.55, s*0.20, s*1.1, s*0.12);
      ctx.fill();

      ctx.strokeStyle = "rgba(255,255,255,0.75)";
      ctx.lineWidth = Math.max(1, s*0.08);
      ctx.beginPath();
      ctx.moveTo(-s*0.05, -s*0.55);
      ctx.quadraticCurveTo(-s*0.35, -s*0.95, -s*0.65, -s*0.75);
      ctx.moveTo(s*0.05, -s*0.55);
      ctx.quadraticCurveTo(s*0.35, -s*0.95, s*0.65, -s*0.75);
      ctx.stroke();

      ctx.restore();
    }

    const palette = [
      "#ff7aa2","#ffb3c7","#ffd1e1","#b7f5ff","#a7ffcc",
      "#fff3a7","#cdb6ff","#ff9df0","#b2a4ff","#8cf0ff"
    ];

    const flowerPal = [
      ["#ffd1e1","#ff7aa2","#ffb3c7"],
      ["#b7f5ff","#8cf0ff","#a7ffcc"],
      ["#fff3a7","#ffd1e1","#ffb3c7"],
      ["#cdb6ff","#ff9df0","#ffd1e1"]
    ];

    const particles = [];

    function spawnBurst(x,y,n){
      for(let i=0;i<n;i++){
        const r = Math.random();
        const type = r < 0.42 ? "heart" : (r < 0.78 ? "flower" : "dot");
        particles.push({
          x, y,
          vx: rand(-1.25,1.25),
          vy: rand(-2.3,-0.7),
          a: rand(0.70,1),
          life: rand(1.2,2.4),
          age: 0,
          s: rand(3,9),
          rot: rand(-Math.PI,Math.PI),
          vr: rand(-2.6,2.6),
          color: pick(palette),
          fcol: pick(flowerPal),
          type,
          mode: "free"
        });
      }
    }

    function spawnHeartRing(x,y,count,scale){
      const start = Math.random()*Math.PI*2;
      for(let i=0;i<count;i++){
        const t = start + (i/count)*Math.PI*2;
        const p = heartPoint(t);
        const px = x + p.x * scale;
        const py = y - p.y * scale;
        const type = Math.random()<0.55 ? "heart" : "flower";
        particles.push({
          x: px + rand(-7,7),
          y: py + rand(-7,7),
          vx: rand(-0.25,0.25),
          vy: rand(-0.25,0.25),
          a: rand(0.78,1),
          life: rand(1.9,3.3),
          age: 0,
          s: rand(4,11),
          rot: rand(-Math.PI,Math.PI),
          vr: rand(-1.6,1.6),
          color: pick(palette),
          fcol: pick(flowerPal),
          type,
          mode: "orbit",
          ox: px, oy: py
        });
      }
    }

    function drawTextInHeart(x,y,scale,alpha,now){
      ctx.save();
      ctx.globalAlpha = alpha;
      ctx.translate(x,y);
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      const size = clamp(22*scale, 18, 40);
      ctx.font = `800 ${size}px system-ui, Segoe UI, Arial`;
      const glow = pointer.down ? (18 + 10*Math.sin(now*0.006)) : 18;
      ctx.shadowColor = "rgba(0,0,0,0.70)";
      ctx.shadowBlur = glow;
      ctx.fillStyle = "rgba(255,255,255,0.97)";
      ctx.fillText(CENTER_TEXT, 0, 0);
      ctx.restore();
      return size;
    }

    const bgImg = new Image();
    bgImg.decoding = "async";
    bgImg.src = BG_SRC;
    let bgReady = false;
    bgImg.onload = ()=>{ bgReady = true; };
    bgImg.onerror = ()=>{ bgReady = false; };

    const bokeh = [];
    function resetBokeh(){
      bokeh.length = 0;
      const count = Math.floor(clamp((W*H)/45000, 18, 60));
      for(let i=0;i<count;i++){
        bokeh.push({
          x: rand(0,W),
          y: rand(0,H),
          r: rand(10, 55),
          a: rand(0.10, 0.30),
          col: pick(["#a7ffcc","#b7f5ff","#ffd1e1","#fff3a7","#cdb6ff","#8cf0ff"]),
          dx: rand(-10,10),
          dy: rand(-7,7),
          p: rand(0, Math.PI*2),
          sp: rand(0.4, 1.2)
        });
      }
    }
    resetBokeh();
    window.addEventListener("resize", resetBokeh, { passive:true });

    const petals = [];
    function resetPetals(){
      petals.length = 0;
      const count = Math.floor(clamp((W*H)/70000, 10, 28));
      for(let i=0;i<count;i++){
        petals.push({
          x: rand(0,W),
          y: rand(0,H),
          s: rand(4,10),
          rot: rand(-Math.PI,Math.PI),
          vr: rand(-1.0,1.0),
          vx: rand(-0.18,0.18),
          vy: rand(-0.35,-0.12),
          a: rand(0.22,0.55),
          col: pick(palette),
          kind: Math.random()<0.55 ? "heart" : "dot",
          wob: rand(0, Math.PI*2),
          wsp: rand(0.8, 1.8)
        });
      }
    }
    resetPetals();
    window.addEventListener("resize", resetPetals, { passive:true });

    function drawBackground(now){
      if(bgReady){
        const iw = bgImg.naturalWidth || 1;
        const ih = bgImg.naturalHeight || 1;
        const s = Math.max(W/iw, H/ih);
        const dw = iw*s;
        const dh = ih*s;
        const dx = (W - dw)/2;
        const dy = (H - dh)/2;
        ctx.drawImage(bgImg, dx, dy, dw, dh);

        ctx.save();
        ctx.globalAlpha = 0.18;
        const g = ctx.createLinearGradient(0,0,0,H);
        g.addColorStop(0, "rgba(0,0,0,0.06)");
        g.addColorStop(1, "rgba(0,0,0,0.42)");
        ctx.fillStyle = g;
        ctx.fillRect(0,0,W,H);
        ctx.restore();
      }else{
        const g = ctx.createLinearGradient(0,0,0,H);
        g.addColorStop(0, "#0b1b13");
        g.addColorStop(0.5, "#102618");
        g.addColorStop(1, "#07110c");
        ctx.fillStyle = g;
        ctx.fillRect(0,0,W,H);
      }

      ctx.save();
      ctx.globalCompositeOperation = "screen";
      for(const b of bokeh){
        b.p += b.sp * 0.016;
        const x = (b.x + Math.sin(b.p)*b.dx + W) % W;
        const y = (b.y + Math.cos(b.p*0.9)*b.dy + H) % H;
        ctx.globalAlpha = b.a;
        ctx.fillStyle = b.col;
        ctx.beginPath();
        ctx.arc(x, y, b.r, 0, Math.PI*2);
        ctx.fill();
      }
      ctx.restore();

      for(const p of petals){
        p.wob += p.wsp * 0.016;
        p.rot += p.vr * 0.016;
        p.x += (p.vx + 0.08*Math.sin(p.wob)) * 60 * 0.016;
        p.y += p.vy * 60 * 0.016;
        if(p.y < -40) { p.y = H + rand(10,120); p.x = rand(0,W); }
        if(p.x < -80) p.x = W + 80;
        if(p.x > W + 80) p.x = -80;

        if(p.kind === "heart"){
          drawTinyHeart(p.x, p.y, p.s, p.rot, p.col, p.a);
        }else{
          ctx.save();
          ctx.globalAlpha = p.a;
          ctx.fillStyle = p.col;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.s*0.55, 0, Math.PI*2);
          ctx.fill();
          ctx.restore();
        }
      }
    }

    const butterflies = [];
    function resetButterflies(){
      butterflies.length = 0;
      for(let i=0;i<12;i++){
        butterflies.push({
          ang: rand(0, Math.PI*2),
          spd: rand(0.55, 1.25),
          wob: rand(0, Math.PI*2),
          wobSpd: rand(1.2, 2.8),
          size: rand(6.0, 10.8),
          col: pick(["#ffd1e1","#ffb3c7","#b7f5ff","#a7ffcc","#fff3a7","#cdb6ff"]),
          phase: rand(0, Math.PI*2),
          base: rand(10, 26),
          jitter: rand(0.6, 1.3)
        });
      }
    }
    resetButterflies();
    window.addEventListener("resize", resetButterflies, { passive:true });

    function keepOutsideText(x,y,cx,cy,halfW,halfH,pad){
      const left = cx - halfW - pad;
      const right = cx + halfW + pad;
      const top = cy - halfH - pad;
      const bot = cy + halfH + pad;

      if(x > left && x < right && y > top && y < bot){
        const dx = x - cx;
        const dy = y - cy;
        const ax = Math.abs(dx);
        const ay = Math.abs(dy);
        if(ax/halfW > ay/halfH){
          x = cx + Math.sign(dx || 1) * (halfW + pad);
        }else{
          y = cy + Math.sign(dy || 1) * (halfH + pad);
        }
      }
      return {x,y};
    }

    let last = performance.now();
    function frame(now){
      const dt = Math.min(0.033, (now-last)/1000);
      last = now;

      if (W !== window.innerWidth || H !== window.innerHeight) resize();

      ctx.clearRect(0,0,W,H);
      drawBackground(now);

      if(pointer.live){
        pointer.t += dt;

        const base = pointer.down ? 16.5 : 13.8;
        const pulse = 1 + 0.07*Math.sin(now*0.004);
        const scale = base * pulse;

        const ringRate = pointer.down ? 1.0 : 0.62;
        if(Math.random() < ringRate){
          spawnHeartRing(pointer.x, pointer.y, pointer.down ? 14 : 9, scale);
        }

        const a = clamp(pointer.t/0.22, 0, 1);
        const textScale = pointer.down ? 1.18 : 1.05;

        const textSize = drawTextInHeart(pointer.x, pointer.y, textScale, 0.98*a, now);

        ctx.save();
        ctx.font = `800 ${clamp(22*textScale, 18, 40)}px system-ui, Segoe UI, Arial`;
        const textW = ctx.measureText(CENTER_TEXT).width;
        ctx.restore();

        const cx = pointer.x;
        const cy = pointer.y;

        const halfW = (textW * 0.50);
        const halfH = (textSize * 0.55);
        const pad = pointer.down ? 18 : 14;

        for(const b of butterflies){
          b.ang += b.spd * dt;
          b.wob += b.wobSpd * dt;

          const spread = pointer.down ? 1.12 : 1.06;

          const rxBase = halfW + pad + b.base;
          const ryBase = halfH + pad + (b.base*0.72);

          const rx = rxBase * spread + 6*Math.sin(b.wob*b.jitter);
          const ry = ryBase * spread + 5*Math.cos(b.wob*0.9*b.jitter);

          let x = cx + Math.cos(b.ang) * rx;
          let y = cy + Math.sin(b.ang*1.03) * ry;

          x += 6*Math.sin(b.wob*1.05);
          y += 5*Math.cos(b.wob*0.88);

          const pushed = keepOutsideText(x,y,cx,cy,halfW,halfH,pad);
          x = pushed.x; y = pushed.y;

          const tx = cx + Math.cos(b.ang + 0.02) * rx;
          const ty = cy + Math.sin((b.ang + 0.02)*1.03) * ry;
          const rot = Math.atan2(ty - y, tx - x);

          const flap = now*0.012 + b.phase;
          drawButterfly(x, y, b.size, rot, flap, 0.92, b.col);
        }
      }

      for(let i=particles.length-1;i>=0;i--){
        const p = particles[i];
        p.age += dt;
        if(p.age >= p.life){ particles.splice(i,1); continue; }

        const k = 1 - (p.age/p.life);
        const fade = clamp(k*k, 0, 1);

        if(p.mode === "free"){
          p.vy += 1.85*dt;
          p.x += p.vx * 60 * dt;
          p.y += p.vy * 60 * dt;
        }else{
          p.x += (p.ox - p.x) * (1 - Math.pow(0.0001, dt));
          p.y += (p.oy - p.y) * (1 - Math.pow(0.0001, dt));
          p.x += p.vx * 42 * dt;
          p.y += p.vy * 42 * dt;
        }

        p.rot += p.vr * dt;

        if(p.type === "heart"){
          drawTinyHeart(p.x, p.y, p.s, p.rot, p.color, p.a*fade);
        }else if(p.type === "flower"){
          drawFlower(p.x, p.y, p.s*1.15, p.rot, p.fcol, p.a*fade);
        }else{
          ctx.save();
          ctx.globalAlpha = p.a*fade;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.s*0.55, 0, Math.PI*2);
          ctx.fill();
          ctx.restore();
        }
      }

      requestAnimationFrame(frame);
    }
    requestAnimationFrame(frame);
  </script>
</body>
</html>